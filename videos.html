<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assistir Vídeos</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
</head>
<body>
    <h1>Vídeos do YouTube</h1>
    <div id="videosContainer"></div>

    <script>
        const firebaseConfig = {
            apiKey: "SUA_API_KEY",
            authDomain: "SEU_AUTH_DOMAIN",
            projectId: "SEU_PROJECT_ID",
            storageBucket: "SEU_STORAGE_BUCKET",
            messagingSenderId: "SEU_MESSAGING_SENDER_ID",
            appId: "SEU_APP_ID"
        };

        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const videosContainer = document.getElementById('videosContainer');

        // Pega os links e dados dos vídeos
        db.collection('youtubeLinks').orderBy('data', 'desc').onSnapshot((querySnapshot) => {
            videosContainer.innerHTML = '';  // Limpa o container
            querySnapshot.forEach((doc) => {
                const data = doc.data();
                const iframe = document.createElement('iframe');
                iframe.width = '560';
                iframe.height = '315';
                iframe.src = `https://www.youtube.com/embed/${extractVideoId(data.url)}`;
                iframe.frameBorder = '0';
                iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture';
                iframe.allowFullscreen = true;

                const videoTitle = document.createElement('h3');
                videoTitle.textContent = data.titulo;

                const videoTime = document.createElement('p');
                videoTime.innerHTML = `<strong>Tempo estimado:</strong> ${data.minutos} minutos`;

                const videoData = document.createElement('p');
                videoData.innerHTML = `<em>Adicionado em: ${data.data.toDate().toLocaleString()}</em>`;

                const videoLink = document.createElement('a');
                videoLink.href = data.url;
                videoLink.target = '_blank';
                videoLink.textContent = 'Assista no YouTube';

                const videoItem = document.createElement('div');
                videoItem.appendChild(videoTitle);
                videoItem.appendChild(iframe);
                videoItem.appendChild(videoTime);
                videoItem.appendChild(videoData);
                videoItem.appendChild(videoLink);
                videosContainer.appendChild(videoItem);
            });
        });

        // Função para extrair o ID do vídeo
        function extractVideoId(url) {
            const regex = /(?:https?:\/\/(?:www\.)?(?:youtube\.com\/(?:[^\/\n\s]+\/\S+|(?:v|e(?:mbed)?)\/?([^&?]*)))|youtu\.be\/([^&?]*))/;
            const match = url.match(regex);
            return match ? match[1] : null;
        }
    </script>
</body>
</html>
